{"version":3,"file":"mini-vue.esm.js","sources":["../src/shared/index.ts","../src/reactivity/operations.ts","../src/reactivity/effect.ts","../src/reactivity/baseHandlers.ts","../src/reactivity/collectionHandlers.ts","../src/reactivity/reactive.ts","../src/reactivity/ref.ts"],"sourcesContent":["export * from \"./shapeFlags\";\n\nconst camelizeRE = /-(\\w)/g;\n/**\n * @private\n * 把烤肉串命名方式转换成驼峰命名方式\n */\nexport const camelize = (str: string): string => {\n  return str.replace(camelizeRE, (_, c) => (c ? c.toUpperCase() : \"\"));\n};\n\n/**\n * @private\n * 首字母大写\n */\nexport const capitalize = (str: string) =>\n  str.charAt(0).toUpperCase() + str.slice(1);\n\n/**\n * @private\n * 添加 on 前缀，并且首字母大写\n */\nexport const toHandlerKey = (str: string) =>\n  str ? `on${capitalize(str)}` : ``;\n\nexport const hasChanged = (value: any, oldValue: any): boolean => value !== oldValue && (value === value || oldValue === oldValue)\n\nexport const isString = (val: unknown): val is string => typeof val === 'string'\n\nexport const isIntegerKey = (key: unknown) =>\n  isString(key) &&\n  key !== 'NaN' &&\n  key[0] !== '-' &&\n  '' + parseInt(key, 10) === key\n\nexport const isMap = (val: unknown): val is Map<any, any> =>\n  toTypeString(val) === '[object Map]'\n\nexport const objectToString = Object.prototype.toString\n\nexport const toTypeString = (value: unknown): string =>\n  objectToString.call(value)\n\nexport const isObject = (val: unknown): val is Record<any, any> => val !== null && typeof val === 'object'\n\nexport const toRawType = (value: unknown): string => {\n  // extract \"RawType\" from strings like \"[object RawType]\"\n  return toTypeString(value).slice(8, -1)\n}\n\nexport const isSymbol = (val: unknown): val is symbol => typeof val === 'symbol'\n","// using literal strings instead of numbers so that it's easier to inspect\n// debugger events\n\nexport const enum TrackOpTypes {\n  GET = 'get',\n  HAS = 'has',\n  ITERATE = 'iterate'\n}\n\nexport const enum TriggerOpTypes {\n  SET = 'set',\n  ADD = 'add',\n  DELETE = 'delete',\n  CLEAR = 'clear'\n}","import { hasChanged, isIntegerKey, isMap } from '../shared'\nimport { TriggerOpTypes } from './operations'\n// 通过闭包保存当前的cb\nconst effectStack: any = []\n\nconst trackStack: boolean[] = []\n\nlet activeEffect\n\nlet uid = 0\n\nlet shouldTrack = true\n\nconst targetMap = new WeakMap()\n\nfunction cleanup(effect) {\n  const { deps } = effect\n  if (deps.length) {\n    for (let i = 0; i < deps.length; i++) {\n      deps[i].delete(effect)\n    }\n    deps.length = 0\n  }\n}\n\nexport function resetTracking() {\n  const last = trackStack.pop()\n  shouldTrack = last === undefined ? true : last\n}\n\nexport function enableTracking() {\n  trackStack.push(shouldTrack)\n  shouldTrack = true\n}\n// effect 钩子函数\nexport function isEffect(fn: any) {\n  return fn && fn._isEffect === true\n}\n\nexport function effect(\n  fn,\n  options: any = {}): any {\n  if (isEffect(fn)) {\n    fn = fn.raw\n  }\n  // 真正的创建方法在这里\n  const effect = createReactiveEffect(fn, options)\n  if (!options.lazy) {\n    effect()\n  }\n  return effect\n}\n\n\nfunction createReactiveEffect(\n  fn,\n  options) {\n  const effect = function reactiveEffect() {\n    if (!effect.active) {\n      return options.scheduler ? undefined : fn()\n    }\n    if (!effectStack.includes(effect)) {\n      cleanup(effect)\n      try {\n        enableTracking()\n        // 给当前的watcher 放进effectstack 的肚子里,临时放入，为了在依赖收集的时候能访问到当前真的effect\n        effectStack.push(effect)\n        // 给当前的这个effect 变为活动的effect\n        activeEffect = effect\n        // 执行以下\n        return fn()\n      } finally {\n        // 执行成功了出栈\n        effectStack.pop()\n        resetTracking()\n        activeEffect = effectStack[effectStack.length - 1]\n      }\n    }\n  }\n  effect.id = uid++\n  effect.allowRecurse = !!options.allowRecurse\n  effect._isEffect = true\n  effect.active = true\n  effect.raw = fn\n  effect.deps = []\n  effect.options = options\n  return effect\n}\n\nexport function track(target: object, type, key: unknown) {\n  if (!shouldTrack || activeEffect === undefined) {\n    return\n  }\n  let depsMap = targetMap.get(target)\n  if (!depsMap) {\n    targetMap.set(target, (depsMap = new Map()))\n  }\n  let dep = depsMap.get(key)\n  if (!dep) {\n    depsMap.set(key, (dep = new Set()))\n  }\n  if (!dep.has(activeEffect)) {\n    dep.add(activeEffect)\n    activeEffect.deps.push(dep)\n  }\n}\n\nexport function trigger(\n  target: object,\n  type: TriggerOpTypes,\n  key?: unknown,\n  newValue?: unknown,\n  oldValue?: unknown,\n  oldTarget?: Map<unknown, unknown> | Set<unknown>) {\n  const depsMap = targetMap.get(target)\n  if (!depsMap) {\n    // never been tracked\n    return\n  }\n\n  const effects = new Set()\n  const add = (effectsToAdd) => {\n    if (effectsToAdd) {\n      effectsToAdd.forEach(effect => {\n        if (effect !== activeEffect || effect.allowRecurse) {\n          effects.add(effect)\n        }\n      })\n    }\n  }\n\n  if (type === TriggerOpTypes.CLEAR) {\n    // collection being cleared\n    // trigger all effects for target\n    depsMap.forEach(add)\n  } else if (key === 'length' && Array.isArray(target)) {\n    depsMap.forEach((dep, key) => {\n      if (key === 'length' || key >= (newValue as number)) {\n        add(dep)\n      }\n    })\n  } else {\n    // schedule runs for SET | ADD | DELETE\n    if (key !== void 0) {\n      add(depsMap.get(key))\n    }\n\n    // also run for iteration key on ADD | DELETE | Map.SET\n    switch (type) {\n      case TriggerOpTypes.ADD:\n        if (!Array.isArray(target)) {\n          add(depsMap.get(Symbol('')))\n          if (isMap(target)) {\n            add(depsMap.get(Symbol('')))\n          }\n        } else if (isIntegerKey(key)) {\n          // new index added to array -> length changes\n          add(depsMap.get('length'))\n        }\n        break\n      case TriggerOpTypes.DELETE:\n        if (!Array.isArray(target)) {\n          add(depsMap.get(Symbol('')))\n          if (isMap(target)) {\n            add(depsMap.get(Symbol('')))\n          }\n        }\n        break\n      case TriggerOpTypes.SET:\n        if (isMap(target)) {\n          add(depsMap.get(Symbol('')))\n        }\n        break\n    }\n  }\n\n  const run = (effect) => {\n\n    if (effect.options.scheduler) {\n      effect.options.scheduler(effect)\n    } else {\n      effect()\n    }\n  }\n\n  effects.forEach(run)\n}","import {\n  reactive,\n  readonly,\n  toRaw,\n  ReactiveFlags,\n  readonlyMap,\n  reactiveMap,\n  shallowReactiveMap,\n  shallowReadonlyMap\n} from './reactive'\nimport { isRef } from './ref'\nimport { track, trigger } from './effect'\nimport { isObject, isSymbol, isIntegerKey, hasChanged } from '../shared'\nimport { TrackOpTypes, TriggerOpTypes } from './operations'\nexport const readonlyHandlers: ProxyHandler<object> = {\n  get: createGetter(true),\n  set(target, key) {\n    return true\n  },\n  deleteProperty(target, key) {\n    return true\n  }\n}\n\nexport const hasOwn = (\n  val: object,\n  key: string | symbol): any => {\n  Object.prototype.hasOwnProperty.call(val, key)\n}\n\nconst builtInSymbols = new Set(\n  Object.getOwnPropertyNames(Symbol)\n    .map(key => (Symbol as any)[key])\n    .filter(isSymbol)\n)\n\nexport function makeMap(\n  str: string,\n  expectsLowerCase?: boolean): (key: string) => boolean {\n  const map: Record<string, boolean> = Object.create(null)\n  const list: Array<string> = str.split(',')\n  for (let i = 0; i < list.length; i++) {\n    map[list[i]] = true\n  }\n  return expectsLowerCase ? val => !!map[val.toLowerCase()] : val => !!map[val]\n}\n\nconst isNonTrackableKeys = /*#__PURE__*/ makeMap(`__proto__,__v_isRef,__isVue`)\n\nconst arrayInstrumentations: Record<string, Function> = {}\n\nfunction createGetter(isReadonly = false, shallow = false) {\n  return function get(target, key, receiver) {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly\n    } else if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly\n    } else if (\n      key === ReactiveFlags.RAW &&\n      receiver ===\n      (isReadonly\n        ? shallow\n          ? shallowReadonlyMap\n          : readonlyMap\n        : shallow\n          ? shallowReactiveMap\n          : reactiveMap\n      ).get(target)\n    ) {\n      return target\n    }\n\n    const targetArray = Array.isArray(target)\n\n    if (!isReadonly && targetArray && hasOwn(arrayInstrumentations, key)) {\n      return Reflect.get(arrayInstrumentations, key, receiver)\n    }\n\n    const res = Reflect.get(target, key, receiver)\n\n    if (\n      isSymbol(key)\n        ? builtInSymbols.has(key as symbol)\n        : isNonTrackableKeys(key)\n    ) {\n      return res\n    }\n\n    if (!isReadonly) {\n      track(target, TrackOpTypes.GET, key)\n    }\n\n    if (shallow) {\n      return res\n    }\n\n    if (isRef(res)) {\n      // ref unwrapping - does not apply for Array + integer key.\n      const shouldUnwrap = !targetArray || !isIntegerKey(key)\n      return shouldUnwrap ? res.value : res\n    }\n\n    if (isObject(res)) {\n      // Convert returned value into a proxy as well. we do the isObject check\n      // here to avoid invalid value warning. Also need to lazy access readonly\n      // and reactive here to avoid circular dependency.\n      return isReadonly ? readonly(res) : reactive(res)\n    }\n\n    return res\n  }\n}\n\nfunction createSetter(shallow = false) {\n  return function set(\n    target: object,\n    key: string | symbol,\n    value: unknown,\n    receiver: object\n  ): boolean {\n    let oldValue = (target as any)[key]\n    if (!shallow) {\n      value = toRaw(value)\n      oldValue = toRaw(oldValue)\n      if (!Array.isArray(target) && isRef(oldValue) && !isRef(value)) {\n        oldValue.value = value\n        return true\n      }\n    } else {\n      // in shallow mode, objects are set as-is regardless of reactive or not\n    }\n\n    const hadKey =\n      Array.isArray(target) && isIntegerKey(key)\n        ? Number(key) < target.length\n        : hasOwn(target, key)\n    const result = Reflect.set(target, key, value, receiver)\n    // don't trigger if target is something up in the prototype chain of original\n    if (target === toRaw(receiver)) {\n      if (!hadKey) {\n        trigger(target, TriggerOpTypes.ADD, key, value)\n      } else if (hasChanged(value, oldValue)) {\n        trigger(target, TriggerOpTypes.SET, key, value, oldValue)\n      }\n    }\n    return result\n  }\n}\n\nconst get = /*#__PURE__*/ createGetter()\n\nconst set = /*#__PURE__*/ createSetter()\n\nconst shallowReadonlyGet = /*#__PURE__*/ createGetter(true, true)\n\nexport const mutableHandlers: any = {\n  get,\n  set,\n  deleteProperty,\n  has,\n  ownKeys\n}\n\nexport const shallowReadonlyHandlers = Object.assign(\n  {},\n  readonlyHandlers,\n  {\n    get: shallowReadonlyGet\n  }\n)\n\nfunction deleteProperty(target: object, key: string | symbol): boolean {\n  const hadKey = hasOwn(target, key)\n  const oldValue = (target as any)[key]\n  const result = Reflect.deleteProperty(target, key)\n  if (result && hadKey) {\n    trigger(target, TriggerOpTypes.DELETE, key, undefined, oldValue)\n  }\n  return result\n}\n\nfunction has(target: object, key: string | symbol): boolean {\n  const result = Reflect.has(target, key)\n  if (!isSymbol(key) || !builtInSymbols.has(key)) {\n    track(target, TrackOpTypes.HAS, key)\n  }\n  return result\n}\n\nfunction ownKeys(target: object): (string | symbol)[] {\n  track(target, TrackOpTypes.ITERATE, Array.isArray(target) ? 'length' : Symbol(''))\n  return Reflect.ownKeys(target)\n}\n","import { readonly, ReactiveFlags, toRaw, reactive } from './reactive'\nimport { track, trigger } from './effect'\nimport { hasOwn } from './baseHandlers'\nimport { hasChanged, isObject, isMap } from '../shared'\nimport { TrackOpTypes, TriggerOpTypes } from './operations'\n\nconst toShallow = <T extends unknown>(value: T): T => value\n\nconst toReadonly = <T extends unknown>(value: T): T => isObject(value) ? readonly(value as Record<any, any>) : value\n\nconst toReactive = <T extends unknown>(value: T): T => isObject(value) ? reactive(value) : value\n\nfunction has(this, key: unknown, isReadonly = false): boolean {\n  const target = (this as any)[ReactiveFlags.RAW]\n  const rawTarget = toRaw(target)\n  const rawKey = toRaw(key)\n  if (key !== rawKey) {\n    !isReadonly && track(rawTarget, TrackOpTypes.HAS, key)\n  }\n  !isReadonly && track(rawTarget, TrackOpTypes.HAS, rawKey)\n  return key === rawKey\n    ? target.has(key)\n    : target.has(key) || target.has(rawKey)\n}\n\nfunction get(\n  target,\n  key: unknown,\n  isReadonly = false,\n  isShallow = false) {\n  // #1772: readonly(reactive(Map)) should return readonly + reactive version\n  // of the value\n  target = (target as any)[ReactiveFlags.RAW]\n  const rawTarget = toRaw(target)\n  const rawKey = toRaw(key)\n  if (key !== rawKey) {\n    !isReadonly && track(rawTarget, TrackOpTypes.GET, key)\n  }\n  !isReadonly && track(rawTarget, TrackOpTypes.GET, rawKey)\n  const { has } = Reflect.getPrototypeOf(rawTarget) as any\n  const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive\n  if (has.call(rawTarget, key)) {\n    return wrap(target.get(key))\n  } else if (has.call(rawTarget, rawKey)) {\n    return wrap(target.get(rawKey))\n  }\n}\n\nfunction add(this, value: unknown) {\n  value = toRaw(value)\n  const target = toRaw(this)\n  const proto = Reflect.getPrototypeOf(target) as any\n  const hadKey = proto.has.call(target, value)\n  if (!hadKey) {\n    target.add(value)\n    trigger(target, TriggerOpTypes.ADD, value, value)\n  }\n  return this\n}\n\nfunction set(this, key: unknown, value: unknown) {\n  value = toRaw(value)\n  const target = toRaw(this)\n  const { has, get } = Reflect.getPrototypeOf(target) as any\n\n  let hadKey = has.call(target, key)\n  if (!hadKey) {\n    key = toRaw(key)\n    hadKey = has.call(target, key)\n  }\n\n  const oldValue = get.call(target, key)\n  target.set(key, value)\n  if (!hadKey) {\n    trigger(target, TriggerOpTypes.ADD, key, value)\n  } else if (hasChanged(value, oldValue)) {\n    trigger(target, TriggerOpTypes.SET, key, value, oldValue)\n  }\n  return this\n}\n\nfunction size(target, isReadonly = false) {\n  target = (target as any)[ReactiveFlags.RAW]\n  !isReadonly && track(toRaw(target), TrackOpTypes.ITERATE, Symbol(''))\n  return Reflect.get(target, 'size', target)\n}\n\nfunction createForEach(isReadonly: boolean, isShallow: boolean) {\n  return function forEach(\n    this,\n    callback: Function,\n    thisArg?: unknown\n  ) {\n    const observed = this as any\n    const target = observed[ReactiveFlags.RAW]\n    const rawTarget = toRaw(target)\n    const wrap = isShallow ? toShallow : isReadonly ? toReadonly : toReactive\n    !isReadonly && track(rawTarget, TrackOpTypes.ITERATE, Symbol(''))\n    return target.forEach((value: unknown, key: unknown) => {\n      // important: make sure the callback is\n      // 1. invoked with the reactive map as `this` and 3rd arg\n      // 2. the value received should be a corresponding reactive/readonly.\n      return callback.call(thisArg, wrap(value), wrap(key), observed)\n    })\n  }\n}\n\nfunction deleteEntry(this, key: unknown) {\n  const target = toRaw(this)\n  const { has, get } = Reflect.getPrototypeOf(target) as any\n  let hadKey = has.call(target, key)\n  if (!hadKey) {\n    key = toRaw(key)\n    hadKey = has.call(target, key)\n  }\n  const oldValue = get ? get.call(target, key) : undefined\n  // forward the operation before queueing reactions\n  const result = target.delete(key)\n  if (hadKey) {\n    trigger(target, TriggerOpTypes.DELETE, key, undefined, oldValue)\n  }\n  return result\n}\n\nconst readonlyInstrumentations: Record<string, Function> = {\n  get(this, key: unknown) {\n    return get(this, key, true)\n  },\n  get size() {\n    return size((this as unknown), true)\n  },\n  has(this, key: unknown) {\n    return has.call(this, key, true)\n  },\n  add: createReadonlyMethod(TriggerOpTypes.ADD),\n  set: createReadonlyMethod(TriggerOpTypes.SET),\n  delete: createReadonlyMethod(TriggerOpTypes.DELETE),\n  clear: createReadonlyMethod(TriggerOpTypes.CLEAR),\n  forEach: createForEach(true, false)\n}\n\nconst mutableInstrumentations: Record<string, Function> = {\n  get(this, key: unknown) {\n    return get(this, key)\n  },\n  get size() {\n    return size((this as unknown))\n  },\n  has,\n  add,\n  set,\n  delete: deleteEntry,\n  clear,\n  forEach: createForEach(false, false)\n}\n\nfunction clear(this) {\n  const target = toRaw(this)\n  const hadItems = target.size !== 0\n    ? isMap(target)\n      ? new Map(target)\n      : new Set(target)\n    : undefined\n  // forward the operation before queueing reactions\n  const result = target.clear()\n  if (hadItems) {\n    trigger(target, TriggerOpTypes.CLEAR, undefined, undefined)\n  }\n  return result\n}\n\nfunction createInstrumentationGetter(isReadonly: boolean, shallow: boolean) {\n  const instrumentations = shallow\n    ? isReadonly\n      ? shallowReadonlyInstrumentations\n      : shallowInstrumentations\n    : isReadonly\n      ? readonlyInstrumentations\n      : mutableInstrumentations\n\n  return (\n    target,\n    key: string | symbol,\n    receiver\n  ) => {\n    if (key === ReactiveFlags.IS_REACTIVE) {\n      return !isReadonly\n    } else if (key === ReactiveFlags.IS_READONLY) {\n      return isReadonly\n    } else if (key === ReactiveFlags.RAW) {\n      return target\n    }\n\n    return Reflect.get(\n      hasOwn(instrumentations, key) && key in target\n        ? instrumentations\n        : target,\n      key,\n      receiver\n    )\n  }\n}\n\nconst shallowInstrumentations: Record<string, Function> = {\n  get(this, key: unknown) {\n    return get(this, key, false, true)\n  },\n  get size() {\n    return size((this as unknown))\n  },\n  has,\n  add,\n  set,\n  delete: deleteEntry,\n  clear,\n  forEach: createForEach(false, true)\n}\n\nconst shallowReadonlyInstrumentations: Record<string, Function> = {\n  get(this, key: unknown) {\n    return get(this, key, true, true)\n  },\n  get size() {\n    return size((this as unknown), true)\n  },\n  has(this, key: unknown) {\n    return has.call(this, key, true)\n  },\n  add: createReadonlyMethod(TriggerOpTypes.ADD),\n  set: createReadonlyMethod(TriggerOpTypes.SET),\n  delete: createReadonlyMethod(TriggerOpTypes.DELETE),\n  clear: createReadonlyMethod(TriggerOpTypes.CLEAR),\n  forEach: createForEach(true, true)\n}\n\nfunction createReadonlyMethod(type: TriggerOpTypes): Function {\n  return function (this, ...args: unknown[]) {\n    return type === TriggerOpTypes.DELETE ? false : this\n  }\n}\n\nexport const mutableCollectionHandlers = {\n  get: createInstrumentationGetter(false, false)\n}\n\nexport const readonlyCollectionHandlers = {\n  get: createInstrumentationGetter(true, false)\n}\n\nexport const shallowReadonlyCollectionHandlers = {\n  get: createInstrumentationGetter(true, true)\n}\n\n","import {\n  mutableHandlers,\n  readonlyHandlers,\n  shallowReadonlyHandlers\n} from './baseHandlers'\nimport {\n  mutableCollectionHandlers,\n  readonlyCollectionHandlers,\n  shallowReadonlyCollectionHandlers\n} from './collectionHandlers'\nimport { isObject, toRawType } from '../shared'\n\nexport const enum ReactiveFlags {\n  SKIP = '__v_skip',\n  IS_REACTIVE = '__v_isReactive',\n  IS_READONLY = '__v_isReadonly',\n  RAW = '__v_raw'\n}\n\nconst enum TargetType {\n  INVALID = 0,\n  COMMON = 1,\n  COLLECTION = 2\n}\n\nexport const readonlyMap = new WeakMap()\n\nexport const shallowReadonlyMap = new WeakMap()\n\nexport const shallowReactiveMap = new WeakMap()\n\nexport const reactiveMap = new WeakMap()\n\nexport function readonly(\n  target) {\n  return createReactiveObject(\n    target,\n    true,\n    readonlyHandlers,\n    readonlyCollectionHandlers,\n    readonlyMap\n  )\n}\n\nfunction targetTypeMap(rawType: string) {\n  switch (rawType) {\n    case 'Object':\n    case 'Array':\n      return TargetType.COMMON\n    case 'Map':\n    case 'Set':\n    case 'WeakMap':\n    case 'WeakSet':\n      return TargetType.COLLECTION\n    default:\n      return TargetType.INVALID\n  }\n}\n\n// 判断是否是响应式对象\nexport function isReactive(value) {\n  if (isReadonly(value)) {\n    return isReactive((value)[ReactiveFlags.RAW])\n  }\n  return !!(value && (value)[ReactiveFlags.IS_REACTIVE])\n}\n\nexport function isReadonly(value) {\n  return !!(value && value[ReactiveFlags.IS_READONLY])\n}\n\nexport function shallowReadonly(target) {\n  return createReactiveObject(\n    target,\n    true,\n    shallowReadonlyHandlers,\n    shallowReadonlyCollectionHandlers,\n    shallowReadonlyMap\n  )\n}\n\nfunction createReactiveObject(\n  target,\n  isReadonly,\n  baseHandlers,\n  collectionHandlers,\n  proxyMap) {\n  if (!isObject(target)) {\n    return target\n  }\n  // target is already a Proxy, return it.\n  // exception: calling readonly() on a reactive object\n  if (\n    target[ReactiveFlags.RAW] &&\n    !(isReadonly && target[ReactiveFlags.IS_REACTIVE])\n  ) {\n    return target\n  }\n  // target already has corresponding Proxy\n  const existingProxy = proxyMap.get(target)\n  if (existingProxy) {\n    return existingProxy\n  }\n  // only a whitelist of value types can be observed.\n  const targetType = getTargetType(target)\n  if (targetType === TargetType.INVALID) {\n    return target\n  }\n  const proxy = new Proxy(\n    target,\n    targetType === TargetType.COLLECTION ? collectionHandlers : baseHandlers\n  )\n  proxyMap.set(target, proxy)\n  return proxy\n}\n\nfunction getTargetType(value) {\n  return value[ReactiveFlags.SKIP] || !Object.isExtensible(value)\n    ? TargetType.INVALID\n    : targetTypeMap(toRawType(value))\n}\n\nexport function reactive(target: any) {\n  // if trying to observe a readonly proxy, return the readonly version.\n  if (target && (target)[ReactiveFlags.IS_READONLY]) {\n    return target\n  }\n  return createReactiveObject(\n    target,\n    false,\n    mutableHandlers,\n    mutableCollectionHandlers,\n    reactiveMap\n  )\n}\n\nexport function toRaw<T>(observed: T): T {\n  return (\n    (observed && toRaw(observed[ReactiveFlags.RAW])) || observed\n  )\n}\n","\nimport { isReactive, toRaw, reactive } from './reactive'\nimport { track, trigger } from './effect'\nimport { isObject, hasChanged } from '../shared'\nimport { TrackOpTypes, TriggerOpTypes } from './operations'\n\nexport function isRef(r) {\n  return Boolean(r && r.__v_isRef === true)\n}\n\nexport function unref(ref) {\n  return isRef(ref) ? (ref.value as any) : ref\n}\n\nconst convert = (val) => isObject(val) ? reactive(val) : val\n\nconst shallowUnwrapHandlers = {\n  get: (target, key, receiver) => unref(Reflect.get(target, key, receiver)),\n  set: (target, key, value, receiver) => {\n    const oldValue = target[key]\n    if (isRef(oldValue) && !isRef(value)) {\n      oldValue.value = value\n      return true\n    } else {\n      return Reflect.set(target, key, value, receiver)\n    }\n  }\n}\n\nfunction createRef(rawValue: unknown, shallow = false) {\n  if (isRef(rawValue)) {\n    return rawValue\n  }\n  return new RefImpl(rawValue, shallow)\n}\nclass RefImpl {\n  private _value\n\n  public readonly __v_isRef = true\n\n  constructor(private _rawValue, public readonly _shallow = false) {\n    this._value = _shallow ? _rawValue : convert(_rawValue)\n  }\n\n  get value() {\n    track(toRaw(this), TrackOpTypes.GET, 'value')\n    return this._value\n  }\n\n  set value(newVal) {\n    if (hasChanged(toRaw(newVal), this._rawValue)) {\n      this._rawValue = newVal\n      this._value = this._shallow ? newVal : convert(newVal)\n      trigger(toRaw(this), TriggerOpTypes.SET, 'value', newVal)\n    }\n  }\n}\n\nexport function proxyRefs(\n  objectWithRefs) {\n  return isReactive(objectWithRefs)\n    ? objectWithRefs\n    : new Proxy(objectWithRefs, shallowUnwrapHandlers)\n}\n\nexport function ref(value?: unknown): any {\n  return createRef(value)\n}\n\n"],"names":["has","get","set"],"mappings":"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"}